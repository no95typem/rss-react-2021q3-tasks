{"version":3,"file":"server.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAIA;;;;;;;;;;;;;;;;;;;;;;;ACRA;AAEA;;AAEA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AANA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAWA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AALA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAhCA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAuCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrDA;AACA;AAOA;AAEA;AACA;AACA;AAEA;AAEA;;;AAIA;AACA;AACA;AACA;AACA;AAJA;;AAOA;AACA;AAEA;AACA;AAGA;AAAA;AAAA;AAGA;AALA;AAOA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAVA;AAAA;AAAA;AAAA;AAAA;AAPA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAyBA;;AAEA;AACA;AACA;AAAA;AAQA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AANA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAgBA;AAAA;AAAA;AAAA;AAxBA;AAAA;AAAA;AAAA;AAAA;AA4BA;;;;;;;;;;;;;;;;;;;;;;;;;ACxFA;AAEA;AACA;AAEA;;AAcA;AAGA;AACA;AAEA;AACA;;AACA;AACA;;AACA;AAAA;;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAEA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAIA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AACA;AAAA;AAAA;AAHA;AAKA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AARA;AAAA;AAAA;AAAA;AAAA;AAYA;AACA;AAAA;AAAA;AAAA;AAIA;AAAA;AAIA;AACA;AAFA;AAIA;AAAA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AAHA;AAAA;AAAA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AAkBA;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1GA;AACA;AAGA;AACA;AAEA;;;AAMA;AACA;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;;AACA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;;AAgBA;AACA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AAxBA;AAoCA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtDA;AACA;AACA;AACA;AAGA;AACA;AAEA;AAIA;AACA;AAEA;;AAKA;AAGA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAFA;AAKA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAGA;AACA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AAeA;;AAEA;AACA;AACA;AADA;AAGA;;AAEA;AAAA;AAGA;AACA;AAFA;AAFA;;AASA;AAKA;;;;;;;;;;;;;;;;;;;;;;;AC1FA;AACA;AAEA;;AAQA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAPA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAVA;AAAA;AAAA;AAAA;AAAA;AAaA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1BA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;;;AAKA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAaA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AARA;AAAA;AAAA;AAAA;AAAA;AAbA;AAAA;AAAA;AAAA;AAAA;AAyBA;;AAEA;AACA;AACA;AADA;AAGA;;AAEA;AAAA;AAGA;AACA;AACA;AACA;AAJA;AAFA;;AAWA;AAKA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzEA;AACA;AACA;AAIA;;;;AAYA;AAOA;AAGA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAUA;;AAEA;AAEA;;AACA;AAAA;AAAA;AAAA;;AAEA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AAEA;AACA;AAEA;AAAA;;AAAA;AAAA;AAGA;AAEA;AAAA;;AAAA;AAAA;AAGA;AAEA;AAEA;;AAAA;AAAA;AAIA;AAEA;AAEA;AAAA;AAIA;AAEA;AAAA;AAKA;AACA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AACA;;AACA;AACA;AACA;AACA;AACA;;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAJA;AAFA;AASA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;;AAAA;AAAA;AAUA;AACA;AAIA;;AAAA;AAAA;AAGA;AAKA;AACA;AAIA;;AAAA;AAAA;AAGA;AAGA;;AAAA;AAAA;AAnCA;AAAA;AAAA;AAAA;AAAA;AAyCA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;;AAAA;AAAA;AANA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAnDA;AAAA;AAAA;AAAA;AAAA;AA+DA;;;;;;;;;;;;;;;;;;;;;;;ACjLA;AAEA;;;AAEA;;AAUA;AACA;AAEA;AADA;AAMA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AACA;AACA;AACA;AAAA;;AACA;AACA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AATA;AAAA;AAAA;AAAA;AAAA;AAsBA;;;;;;;;;;;;;;;;;;;;;;;ACtCA;;AAcA;AAEA;AAEA;AAEA;AACA;AACA;AAAA;;AAAA;AAAA;AACA;AAJA;AAMA;AANA;AASA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAhBA;AAAA;AAAA;AAAA;AAAA;AAoBA;AAEA;AACA;AACA;AAGA;;;;;;;;;;;;;;;;;;;;;;;AC9CA;AAEA;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;ACNA;;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAIA;;;;;;;;;;;;;;;;;;;;;;ACRA;;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRA;;AAcA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;;AAAA;AAGA;AAAA;AAHA;AAOA;AAbA;AAAA;AAAA;AAAA;AAAA;AAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAhBA;AAAA;AAAA;AAAA;AAAA;AAqBA;AA1BA;AAAA;AAAA;AAAA;AAAA;AA6BA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7CA;AAEA;AACA;AACA;AACA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;;AAUA;AAEA;;AACA;AAAA;AAAA;AAAA;;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AACA;AAAA;AACA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AANA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AANA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAYA;AACA;AAAA;AAAA;AAFA;AAMA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AALA;AAAA;AAAA;AAAA;AAAA;AAeA;AACA;AAAA;AAAA;AAFA;AAMA;AACA;AACA;AACA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AALA;AAAA;AAAA;AAAA;AAAA;AArCA;AAAA;AAAA;AAAA;AAAA;AAmDA;AACA;AACA;AACA;AAIA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAcA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjBA;AAAA;AAAA;AAAA;AAAA;AAhEA;AAAA;AAAA;AAAA;AAAA;AAVA;AAAA;AAAA;AAAA;AAAA;AAiGA;;;;;;;;;;;;;;;;;;;;;;;ACjIA;AACA;AAKA;AACA;AAgBA;AAQA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAUA;;;;;;;;;;;;;;;;;;;ACnDA;AAAA;;AAAA;AAKA;AAAA;AALA;;AAQA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;;AACA;AACA;AACA;;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;ACnBA;AAKA;AAGA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AARA;AAAA;AAAA;AAUA;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AAvBA;AAAA;AAAA;AAyBA;;AACA;AACA;AACA;;AACA;;AACA;AACA;AAAA;AAAA;;AACA;AAGA;AAAA;AACA;AACA;AArCA;AAAA;AAAA;AAuCA;;AACA;AACA;AAEA;AAAA;AACA;AAAA;AAEA;AAEA;AACA;AACA;AAlDA;;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;ACbA;;;;;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;;AAEA;AACA;AAEA;AAEA;;AACA;;AAKA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAGA;;AAEA;AACA;;AAKA;AACA;AACA;;AAEA;AACA;;AACA;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;AC1EA;AACA;;AAaA;AAGA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AALA;AAOA;AAAA;AAAA;AAPA;AASA;AATA;AAWA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;AACA;AAAA;AAAA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAVA;AAAA;AAAA;AAAA;AAAA;AAbA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAXA;AAAA;AAAA;AAAA;AAAA;AAkDA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5EA;;AAOA;AAGA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAKA;AAEA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAIA;;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAKA;AArBA;AAAA;AAAA;AAAA;AAAA;AANA;AAAA;AAAA;AAAA;AAAA;AA+BA;;;;;;;;;;;;;;;;;;;;;;;;AC1CA;AAEA;AAYA;;AAAA;;AAAA;AAXA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAKA;AAAA;;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AADA;AAAA;AAAA;AAAA;;AAWA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAGA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;AAEA;AACA;;AAAA;AACA;AACA;AAEA;;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAcA;AACA;;AAlBA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;ACdA;AACA;AAGA;AACA;;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AACA;AAEA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AAAA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AAjBA;AAAA;AAAA;AAAA;AAAA;;AAoBA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpCA;AACA;AAQA;AACA;;AAQA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAKA;AACA;AAGA;AAIA;AACA;AACA;AAEA;;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AAUA;AAGA;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAJA;AAOA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AAAA;AACA;AAEA;;;;;;;;;;;;;;;;;AC/GA;AAMA;AACA;AACA;AACA;AAFA;AAIA;;;;;;;;;;;;;;;;;;;ACXA;AAGA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAHA;AAMA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACpCA;AAEA;AACA;AACA;AADA;AAGA;;;;;;;;;;;;;;;;;ACLA;AAMA;AAGA;AACA;AACA;AAFA;AAIA;;;;;;;;;;;;;;;;;ACbA;AAMA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAFA;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACdA;AAKA;AACA;AACA;AAGA;AACA;AACA;AACA;;AAEA;AAGA;AAAA;;AAEA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAIA;AAAA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAfA;AAgBA;AAAA;AAAA;AAAA;;AAhBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;;AACA;AAIA;AACA;;AACA;AACA;AACA;AAAA;AAAA;;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;;AAtBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AADA;AAAA;AAAA;AAAA;AA0BA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACxFA;AAMA;AACA;AACA;AACA;AAFA;AAIA;;;;;;;;;;;;;;;;;ACVA;AAMA;AAGA;AACA;AACA;AAFA;AAIA;;;;;;;;;;;;;;;;;ACbA;AAMA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAFA;AAIA;;;;;;;;;;;;;;;;;ACXA;AAMA;AACA;AACA;AACA;AAFA;AAIA;;;;;;;;;;;;;;;;;ACXA;AAMA;AACA;AACA;AACA;AAFA;AAIA;;;;;;;;;;;;;;;;ACbA;AAGA;AACA;;AAEA;AACA;AACA;AAFA;;;;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AAFA;AAFA;;;;;;;;;;;;;;;;ACFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AALA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHA;AAEA;AAUA;AAEA;;AAEA;AAGA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAEA;;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAPA;AAHA;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAtCA;AAkDA;;AACA;AAAA;AAAA;AAEA;AACA;AAEA;;AAEA;;AAEA;;AAEA;AAGA;AACA;AAEA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAEA;;AAEA;AACA;;AAEA;AACA;AAGA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AANA;AAQA;AAEA;AACA;AACA;AACA;AACA;AAJA;AAOA;AAAA;AAAA;AAAA;AACA;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;;AAHA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAKA;AACA;AANA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAUA;;AAEA;;;;;;;;;;;;;;;ACzJA;;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;ACAA;;AAEA;;;AACA;;AAEA;;AAEA;;;AAGA;;;;;;;;;;;;;;;;;;;;;ACVA;;AAEA;;;AACA;;AAEA;;AAEA;;;AAGA;AAMA;;;;;;;;;;;;;;;;;;;;AChBA;;AAEA;;;AACA;;AAEA;;AAEA;;;AAGA;;;;;;;;;;;;;;;;;;;;ACVA;;AAEA;;;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA;;;;;;;;;;;;;;;AChBA;;;;;;;;;;;;;;;ACAA;AACA;;;;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;ACDA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACNA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAWA;;;AAEA;;AACA;;AACA;;;AAGA;AAEA;;AAEA;AACA;AACA;;AAEA;AAKA;;AAEA;AACA;AAEA;AACA;AACA;AAEA;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AARA;AAUA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AAGA;AADA;AAKA;AACA;AACA;AACA;AAHA;AAMA;AAAA;AAAA;AACA;;AAGA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AACA;AACA;;AAEA;;AAMA;AACA;AAEA;AACA;;AAEA;AACA;AACA","sources":["webpack://react-testing/./src/client/components/404/404.tsx","webpack://react-testing/./src/client/components/about/about.tsx","webpack://react-testing/./src/client/components/app/app.tsx","webpack://react-testing/./src/client/components/content-box/content-box.tsx","webpack://react-testing/./src/client/components/content-box/content-item/content-item.tsx","webpack://react-testing/./src/client/components/details/details.tsx","webpack://react-testing/./src/client/components/error-plug/error-plug.tsx","webpack://react-testing/./src/client/components/gallery/gallery.tsx","webpack://react-testing/./src/client/components/pagination/pagination.tsx","webpack://react-testing/./src/client/components/search-bar/search-bar.tsx","webpack://react-testing/./src/client/components/select/select.tsx","webpack://react-testing/./src/client/components/skeleton/skeleton.tsx","webpack://react-testing/./src/client/components/spinner-border/spinner-border.tsx","webpack://react-testing/./src/client/components/spinner-growing/spinner-growing.tsx","webpack://react-testing/./src/client/components/tag-select/tag-select.tsx","webpack://react-testing/./src/client/components/wh-search-box/wh-search-box.tsx","webpack://react-testing/./src/client/defs.ts","webpack://react-testing/./src/client/lib/generators/generators.ts","webpack://react-testing/./src/client/lib/misc/queue-manager.ts","webpack://react-testing/./src/client/lib/processors/obj-processor.ts","webpack://react-testing/./src/client/lib/react/components/modals/bootstrap-modal.tsx","webpack://react-testing/./src/client/lib/react/components/tables/bs-obj-table.tsx","webpack://react-testing/./src/client/services/img-fetcher/img-fetcher.ts","webpack://react-testing/./src/client/services/open-notification/open-notification.tsx","webpack://react-testing/./src/client/services/wh-api/wh-client-api.ts","webpack://react-testing/./src/client/store/actions/core/setApiKey.ts","webpack://react-testing/./src/client/store/actions/details-page/fetchById.ts","webpack://react-testing/./src/client/store/actions/details-page/reset.ts","webpack://react-testing/./src/client/store/actions/details-page/setData.ts","webpack://react-testing/./src/client/store/actions/details-page/setFlag.ts","webpack://react-testing/./src/client/store/actions/gallery/fetch.ts","webpack://react-testing/./src/client/store/actions/gallery/setContentScrollTop.ts","webpack://react-testing/./src/client/store/actions/gallery/setData.ts","webpack://react-testing/./src/client/store/actions/gallery/setFlag.ts","webpack://react-testing/./src/client/store/actions/gallery/setPagination.ts","webpack://react-testing/./src/client/store/actions/gallery/setQuery.ts","webpack://react-testing/./src/client/store/initials/coreState.ts","webpack://react-testing/./src/client/store/initials/detailsPageFlag.ts","webpack://react-testing/./src/client/store/initials/galleryState.ts","webpack://react-testing/./src/server/wh-server-api.ts","webpack://react-testing/./src/shared/proxy.def.ts","webpack://react-testing/./src/shared/wallheaven-types/categories.ts","webpack://react-testing/./src/shared/wallheaven-types/pagination.ts","webpack://react-testing/./src/shared/wallheaven-types/purity.ts","webpack://react-testing/./src/shared/wallheaven-types/sorting.ts","webpack://react-testing/./src/client/components/search-bar/search.png","webpack://react-testing/./src/client/components/about/about.scss","webpack://react-testing/./src/client/components/app/app.scss","webpack://react-testing/./src/client/components/content-box/content-box.scss","webpack://react-testing/./src/client/components/details/details.scss","webpack://react-testing/./src/client/components/error-plug/error-plug.scss","webpack://react-testing/./src/client/components/gallery/gallery.scss","webpack://react-testing/./src/client/components/search-bar/search-bar.scss","webpack://react-testing/./src/client/components/skeleton/skeleton.scss","webpack://react-testing/./src/client/components/wh-search-box/wh-search-box.scss","webpack://react-testing/external \"body-parser\"","webpack://react-testing/external \"core-js/stable\"","webpack://react-testing/external \"express\"","webpack://react-testing/external \"fs\"","webpack://react-testing/external \"node-fetch\"","webpack://react-testing/external \"path\"","webpack://react-testing/external \"react\"","webpack://react-testing/external \"react-dom\"","webpack://react-testing/external \"react-dom/server\"","webpack://react-testing/external \"react-redux\"","webpack://react-testing/external \"react-router\"","webpack://react-testing/external \"react-router-dom\"","webpack://react-testing/external \"react-transition-group\"","webpack://react-testing/external \"react/jsx-dev-runtime\"","webpack://react-testing/external \"redux\"","webpack://react-testing/external \"regenerator-runtime/runtime\"","webpack://react-testing/webpack/bootstrap","webpack://react-testing/webpack/runtime/compat get default export","webpack://react-testing/webpack/runtime/define property getters","webpack://react-testing/webpack/runtime/hasOwnProperty shorthand","webpack://react-testing/webpack/runtime/make namespace object","webpack://react-testing/webpack/runtime/publicPath","webpack://react-testing/./src/server/entry.tsx"],"sourcesContent":["import * as React from 'react';\n\nexport const NotFoundPage: React.FC = () => {\n  return (\n    <section>\n      <h2>404: Not found</h2>\n    </section>\n  );\n};\n","import * as React from 'react';\n\nimport styles from './about.scss';\n\nexport const About: React.FC = () => {\n  // const videoRef = React.useRef<HTMLVideoElement>(null!);\n\n  // const mediaStreamConstrains: MediaStreamConstraints = {\n  //   video: true,\n  // };\n\n  // navigator.mediaDevices.getUserMedia(mediaStreamConstrains);\n\n  return (\n    <section className={styles.root}>\n      <h2>About</h2>\n      <article className={styles.root__article}>\n        <p>\n          This is my small project for Rolling Scopes School: React 2021 Q3.\n        </p>\n        <section>\n          <p>In the project I learned React basics:</p>\n          <ul>\n            <li>React components (FC and CC)</li>\n            <li>React state, hooks, lifecycle, a data flow pattern</li>\n            <li>React router</li>\n            <li>React transition group</li>\n            <li>React + Redux + thunk</li>\n            <li>React + Jest + React testing library</li>\n          </ul>\n        </section>\n        <section>\n          <p>\n            The project uses <a href=\"https://wallhaven.cc\">Wallhaven</a> API.\n            It is tricky because server responses do not have some essential\n            headers. Therefore app need a cors proxy server.\n          </p>\n        </section>\n        <section>\n          <p>The project written and builded with usage of:</p>\n          <ul>\n            <li>React</li>\n            <li>Redux + thunk</li>\n            <li>Bootstrap CSS and icons</li>\n            <li>Typescript</li>\n            <li>Webpack 5</li>\n          </ul>\n        </section>\n        <p>You can find more at my github repo.</p>\n      </article>\n      {/* <video ref={videoRef} autoPlay></video> */}\n    </section>\n  );\n};\n","import * as React from 'react';\nimport {\n  BrowserRouter,\n  NavLink,\n  Route,\n  Switch,\n  useLocation,\n} from 'react-router-dom';\nimport { CSSTransition, SwitchTransition } from 'react-transition-group';\n\nimport { About } from '../about/about';\nimport { NotFoundPage } from '../404/404';\nimport { DetailsPageReduxed } from '../details/details';\n\nimport styles from './app.scss';\nimport { SpinnerBorder } from '../spinner-border/spinner-border';\nimport { GalleryReduxed } from '../gallery/gallery';\n\n// const GalleryReduxed = React.lazy(() => import('../gallery/gallery'));\n\nconst CSS_TRANSITION_CLASSNAMES = {\n  enter: styles.route_enter,\n  enterActive: styles['route_enter-active'],\n  exit: styles.route_exit,\n  exitActive: styles['route_exit-active'],\n};\n\nconst Routes: React.FC = () => {\n  const location = useLocation();\n\n  return (\n    <SwitchTransition>\n      <CSSTransition\n        key={location.pathname}\n        addEndListener={(node, done) =>\n          node.addEventListener('transitionend', done, false)\n        }\n        classNames={CSS_TRANSITION_CLASSNAMES}\n      >\n        <Switch location={location}>\n          <Route exact path=\"/about\">\n            <About />\n          </Route>\n          <Route exact strict path=\"/\">\n            <GalleryReduxed />\n          </Route>\n          <Route path=\"/details/:id\">\n            <DetailsPageReduxed />\n          </Route>\n          <Route path=\"*\">\n            <NotFoundPage />\n          </Route>\n        </Switch>\n      </CSSTransition>\n    </SwitchTransition>\n  );\n};\n\nexport const App: React.FC = () => {\n  return (\n    <div className={styles.app}>\n      {/* <React.Suspense\n        fallback={\n          <div>\n            <SpinnerBorder />\n          </div>\n        }\n      > */}\n      <header className=\"container-fluid\">\n        <nav>\n          <ul className=\"nav nav-pills\">\n            <li className=\"nav-item\">\n              <NavLink exact strict className=\"nav-link\" to=\"/\">\n                Search\n              </NavLink>\n            </li>\n            <li className=\"nav-item\">\n              <NavLink exact className=\"nav-link\" to=\"/about\">\n                About\n              </NavLink>\n            </li>\n          </ul>\n        </nav>\n      </header>\n      <Routes />\n      {/* </React.Suspense> */}\n    </div>\n  );\n};\n","import * as React from 'react';\n\nimport ContentItem from './content-item/content-item';\nimport { SpinnerBorder } from '../spinner-border/spinner-border';\n\nimport styles from './content-box.scss';\nimport { WHSearchDataItemWithLifecycle } from '../../defs';\n\nexport interface ContentBoxProps {\n  memory: Record<string, WHSearchDataItemWithLifecycle>;\n  onScrollEnd?: () => unknown;\n  end?: boolean;\n  error?: boolean;\n  fetching?: boolean;\n  searchPerformed?: boolean;\n  onScroll?: (scrollTop: number) => unknown;\n  scrollTop?: number;\n}\n\nexport const ContentBox: React.FC<ContentBoxProps> = (\n  props: ContentBoxProps,\n) => {\n  const root = React.useRef<HTMLDivElement>(null);\n  const spinDiv = React.useRef<HTMLDivElement>(null);\n\n  React.useEffect(() => {\n    const div = root.current as HTMLDivElement;\n    if (div) {\n      if (props.scrollTop) div.scrollTop = props.scrollTop;\n      div.onscroll = () => {\n        props.onScroll?.(div.scrollTop);\n        const rect = spinDiv.current?.getBoundingClientRect();\n        const height = window.innerHeight;\n        if (rect && rect?.top < height) props.onScrollEnd?.();\n      };\n      return () => {\n        div.onscroll = null;\n      };\n    }\n    return undefined;\n  }, []);\n\n  const cards = Object.values(props.memory);\n  const oneLoaded = cards.some(v => v.loadSuccess !== undefined);\n\n  let content: JSX.Element | JSX.Element[] | undefined;\n\n  if (props.error)\n    content = (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        Fetching error!\n      </div>\n    );\n  else if (!oneLoaded && props.fetching)\n    content = (\n      <div className={styles['content-item_plug']}>\n        <SpinnerBorder />\n      </div>\n    );\n  else if (cards.length > 0)\n    content = cards.map(rec => {\n      return (\n        <article key={rec.id}>\n          <ContentItem data={rec} />\n        </article>\n      );\n    });\n  else if (props.searchPerformed)\n    content = (\n      <div className=\"alert alert-light\" role=\"alert\">\n        Found nothing\n      </div>\n    );\n  else\n    content = (\n      <div\n        className=\"info info-primary d-flex align-items-center\"\n        role=\"contentinfo\"\n        style={{ gap: '10px' }}\n      >\n        <div>\n          <i className=\"bi-search\"></i>\n        </div>\n        <div>Try to search anything!</div>\n      </div>\n    );\n\n  return (\n    <div className={styles.root} ref={root} role=\"grid\">\n      {props.error || cards.length === 0 ? (\n        content\n      ) : (\n        <div className={styles.root__cards}>\n          {content}\n          {props.end || (props.fetching && cards.length === 0) ? undefined : (\n            <div\n              className={`${styles['root__spinner-box']} ${styles['content-item_plug']}`}\n              ref={spinDiv}\n            >\n              <SpinnerBorder />\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n","import * as React from 'react';\nimport { useHistory } from 'react-router';\n\nimport { WHSearchDataItemWithLifecycle } from '../../../defs';\nimport { ErrorPlug } from '../../error-plug/error-plug';\nimport { Skeleton } from '../../skeleton/skeleton';\n\nimport styles from '../content-box.scss';\n\nexport interface ContentItemProps {\n  data: WHSearchDataItemWithLifecycle;\n}\n\nconst ContentItem: React.FC<ContentItemProps> = (props: ContentItemProps) => {\n  const history = useHistory();\n\n  switch (props.data.loadSuccess) {\n    case undefined:\n      return <Skeleton />;\n    case true:\n      return (\n        <div\n          className={styles['content-item__wrapper']}\n          data-testid=\"content-img\"\n        >\n          <img\n            className={styles['content-item_Image']}\n            src={props.data.thumbs.small}\n            alt=\"\"\n            width=\"100%\"\n            onClick={() => {\n              history.push(`/details/${props.data.id}`);\n            }}\n            role=\"img\"\n          />\n        </div>\n      );\n    case false:\n    default:\n      return (\n        <div\n          data-testid=\"content-img\"\n          className={styles['content-item__wrapper']}\n        >\n          <ErrorPlug\n            size=\"30%\"\n            text=\"Failed to load the image\"\n            color=\"rgba(190, 0, 0, 0.5)\"\n          />\n        </div>\n      );\n  }\n};\n\nexport default ContentItem;\n","import * as React from 'react';\nimport { connect } from 'react-redux';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { bindActionCreators, Dispatch } from 'redux';\n\nimport { State } from '../../store/state';\nimport { fetchById } from '../../store/actions/details-page/fetchById';\nimport { resetDetailsPageState } from '../../store/actions/details-page/reset';\n\nimport {\n  BsObjTable,\n  BsObjTableProps,\n} from '../../lib/react/components/tables/bs-obj-table';\nimport { SpinnerBorder } from '../spinner-border/spinner-border';\nimport { SpinnerGrowing } from '../spinner-growing/spinner-growing';\n\nimport styles from './details.scss';\n\nexport type DetailsPageProps = ReturnType<typeof mapStateToProps> &\n  ReturnType<typeof mapDispatchToProps>;\n\nexport const DetailsPage: React.FC<DetailsPageProps> = (\n  props: DetailsPageProps,\n) => {\n  const { flags, data } = props.detailsPageState;\n  const params = useParams<{ id: string }>();\n  const history = useHistory();\n\n  React.useEffect(() => {\n    props.fetchById(params.id);\n    return () => {\n      props.resetDetailsPageState();\n    };\n  }, [params.id]);\n\n  let content: JSX.Element | undefined;\n\n  if (flags.dataLoaded === undefined) content = <SpinnerBorder />;\n  else if (flags.dataLoaded === false || flags.imgPreloaded === false)\n    content = (\n      <div className=\"alert alert-error\" role=\"alert\">\n        Failed to load image\n      </div>\n    );\n  else if (flags.imgPreloaded) content = <img src={data?.path} />;\n  else content = <SpinnerGrowing />;\n\n  const bsObjTableProps: BsObjTableProps = {\n    obj: (data as unknown as Record<string, unknown>) || {},\n    header: 'INFO',\n  };\n\n  return (\n    <section className={styles.root}>\n      <aside className={`${styles.root__aside} table-responsive table-sm`}>\n        <BsObjTable {...bsObjTableProps} />\n      </aside>\n      <div className={styles.root__content}>\n        {content}\n        <button\n          className={`${styles['root__btn-backward']} btn btn-secondary`}\n          onClick={() => history.goBack()}\n        >\n          Back to search\n        </button>\n      </div>\n    </section>\n  );\n};\n\nconst mapStateToProps = (store: State) => {\n  return {\n    detailsPageState: store.detailsPageState,\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch) =>\n  bindActionCreators(\n    {\n      fetchById,\n      resetDetailsPageState,\n    },\n    dispatch,\n  );\n\nexport const DetailsPageReduxed = connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(DetailsPage);\n\nexport default DetailsPageReduxed;\n","/* eslint-disable max-len */\nimport * as React from 'react';\n\nimport styles from './error-plug.scss';\n\nexport interface ErrorPlugProps {\n  color?: string;\n  size?: string;\n  text?: string;\n}\n\nexport const ErrorPlug: React.FC<ErrorPlugProps> = (props: ErrorPlugProps) => {\n  return (\n    <div className={styles.root} role=\"status\">\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        fill={props.color || 'red'}\n        viewBox=\"0 0 16 16\"\n        width={props.size || '50%'}\n        height={props.size || '50%'}\n      >\n        <path d=\"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z\" />\n      </svg>\n      <span>{props.text}</span>\n    </div>\n  );\n};\n","import * as React from 'react';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { State } from '../../store/state';\nimport { setQuery } from '../../store/actions/gallery/setQuery';\nimport { FetchSearch } from '../../store/actions/gallery/fetch';\nimport { setContentScrollTop } from '../../store/actions/gallery/setContentScrollTop';\nimport { setApiKey } from '../../store/actions/core/setApiKey';\n\nimport { ContentBox } from '../content-box/content-box';\nimport { WHSearchBox } from '../wh-search-box/wh-search-box';\nimport { modQuery } from '../../services/wh-api/wh-client-api';\n\nimport styles from './gallery.scss';\n\nexport type GalleryProps = ReturnType<typeof mapStateToProps> &\n  ReturnType<typeof mapDispatchToProps>;\n\nconst Gallery: React.FC<GalleryProps> = (props: GalleryProps) => {\n  const { flags, dataMap, query, paginationData, contentScrollTop } =\n    props.galleryState;\n\n  return (\n    <section className={styles.root}>\n      <WHSearchBox\n        query={query}\n        onChange={(val, key) => {\n          const newQuery = modQuery(query, key, val);\n          if (key === 'apiKey') props.setApiKey(newQuery.apiKey);\n          props.setQuery(newQuery);\n          if (newQuery.page !== query.page) props.Fetch(false, newQuery);\n        }}\n        onSubmit={() => props.Fetch(false)}\n        busy={flags.fetching}\n        pagination={paginationData}\n      />\n      <ContentBox\n        memory={dataMap}\n        onScrollEnd={() => props.Fetch(true)}\n        end={flags.end}\n        error={flags.error}\n        fetching={flags.fetching}\n        searchPerformed={flags.searchPerformed}\n        scrollTop={contentScrollTop}\n        onScroll={v => props.setContentScrollTop(v)}\n      />\n    </section>\n  );\n};\n\nconst mapStateToProps = (store: State) => {\n  return {\n    galleryState: store.galleryState,\n  };\n};\n\nconst mapDispatchToProps = (dispatch: Dispatch) =>\n  bindActionCreators(\n    {\n      setQuery,\n      Fetch: FetchSearch,\n      setContentScrollTop,\n      setApiKey,\n    },\n    dispatch,\n  );\n\nexport const GalleryReduxed = connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(Gallery);\n\nexport default GalleryReduxed;\n","import * as React from 'react';\nimport { genUniqId } from '../../lib/generators/generators';\nimport {\n  DEFAULT_WH_PER_PAGE_VALUE,\n  WHPerPageValues,\n} from '../../../shared/wallheaven-types/pagination';\nimport { Select } from '../select/select';\n\nexport interface PaginationProps {\n  disabled?: boolean;\n  current?: number;\n  total?: number;\n  perPage?: number;\n  onChange?: (newPage: number) => unknown;\n  onPerPageChange?: (newPerPage: number) => unknown;\n  maxBtns: number;\n}\n\nconst createPaginatorItem = (\n  val: string | number,\n  active?: boolean,\n  disabled?: boolean,\n  changeHandler?: React.MouseEventHandler<HTMLLIElement>,\n  key?: string,\n): JSX.Element => {\n  const classList = `page-item\n    ${active ? 'active' : ''}\n    ${disabled ? 'disabled' : ''}`;\n  const onChange = disabled ? undefined : changeHandler;\n  return (\n    <li className={classList} onClick={onChange} key={key}>\n      <a\n        className=\"page-link\"\n        href=\"#\"\n        role={typeof val === 'number' ? 'radio' : 'button'}\n      >\n        {val}\n      </a>\n    </li>\n  );\n};\n\nexport const Pagination: React.FC<PaginationProps> = (\n  props: PaginationProps,\n) => {\n  const [specPos, setSpecPos] = React.useState<number | undefined>(undefined);\n\n  React.useEffect(() => {\n    setSpecPos(undefined);\n  }, [props.current]);\n\n  if (!props.current) return <></>;\n\n  const pages = Math.ceil((props.total ?? 999999) / (props.perPage ?? 1));\n\n  const pos = specPos || props.current;\n\n  let itemsLeft = props.maxBtns;\n\n  const atFirst = props.current === 1;\n  const atLast = props.current === pages;\n\n  const first = createPaginatorItem(1, atFirst, props.disabled, () =>\n    props.onChange?.(1),\n  );\n  itemsLeft--;\n\n  const last = createPaginatorItem(pages, atLast, props.disabled, () =>\n    props.onChange?.(pages),\n  );\n  itemsLeft--;\n\n  const current =\n    !atFirst && !atLast\n      ? createPaginatorItem(pos, pos === props.current, props.disabled, () =>\n          props.onChange?.(pos),\n        )\n      : undefined;\n  if (current) itemsLeft--;\n\n  const leftExpand =\n    pos - 1 > itemsLeft / 2\n      ? createPaginatorItem('...', false, props.disabled, () =>\n          setSpecPos(Math.round(pos / 2)),\n        )\n      : undefined;\n  const rightExpand =\n    pages - (pos + 1) > itemsLeft / 2\n      ? createPaginatorItem('...', false, props.disabled, () =>\n          setSpecPos(Math.round((pages - pos) / 2 + pos)),\n        )\n      : undefined;\n\n  if (leftExpand) itemsLeft--;\n  if (rightExpand) itemsLeft--;\n\n  let leftNeighboursCount = 0;\n  let rightNeighboursCount = 0;\n  let leftBorderFound = false;\n  let rightBorderFound = false;\n\n  while ((!leftBorderFound || !rightBorderFound) && itemsLeft > 0) {\n    if (pos + rightNeighboursCount + 1 < pages) {\n      rightNeighboursCount++;\n      itemsLeft--;\n    } else leftBorderFound = true;\n    if (!itemsLeft) break;\n    if (pos - leftNeighboursCount - 1 > 1) {\n      leftNeighboursCount++;\n      itemsLeft--;\n    } else rightBorderFound = true;\n  }\n\n  return (\n    <nav\n      aria-label=\"Page navigation\"\n      style={{\n        display: 'grid',\n        width: '100%',\n        alignItems: 'center',\n        gridTemplateColumns: '1fr auto 1fr',\n      }}\n    >\n      <div></div>\n      <ul className=\"pagination\">\n        {createPaginatorItem('<', false, props.disabled || atFirst, () =>\n          props.onChange?.(\n            props.current && props.current > 1 ? props.current - 1 : 1,\n          ),\n        )}\n        {first}\n        {leftExpand}\n        {Array(leftNeighboursCount)\n          .fill(null)\n          .map((v, i) => {\n            const p = pos - leftNeighboursCount + i;\n            return createPaginatorItem(\n              p,\n              p === props.current,\n              props.disabled,\n              () => props.onChange?.(p),\n              genUniqId(),\n            );\n          })}\n        {current}\n        {Array(rightNeighboursCount)\n          .fill(null)\n          .map((v, i) => {\n            const p = pos + 1 + i;\n            return createPaginatorItem(\n              p,\n              p === props.current,\n              props.disabled,\n              () => props.onChange?.(p),\n              genUniqId(),\n            );\n          })}\n        {rightExpand}\n        {last}\n        {createPaginatorItem('>', false, props.disabled || atLast, () =>\n          props.onChange?.(\n            props.current && props.current < pages ? props.current + 1 : pages,\n          ),\n        )}\n      </ul>\n      <div style={{ width: 'fit-content', justifySelf: 'end' }}>\n        <Select\n          value={`${props.perPage}` || DEFAULT_WH_PER_PAGE_VALUE}\n          ariaLabel=\"Set items per page\"\n          options={Object.keys(WHPerPageValues).map(v => {\n            return { value: v, text: v };\n          })}\n          onChange={v => props.onPerPageChange?.(Number.parseInt(v, 10))}\n        />\n      </div>\n    </nav>\n  );\n};\n","import * as React from 'react';\n\nimport styles from './search-bar.scss';\n\nconst magnifyingGlass = require('./search.png');\n\nexport interface SearchBarProps {\n  text?: string;\n  className?: string;\n  onChange: (e: React.ChangeEvent) => void;\n  onSubmit?: () => void;\n  busy?: boolean;\n}\n\nexport const SearchBar: React.FC<SearchBarProps> = (props: SearchBarProps) => {\n  return (\n    <div\n      className={`${styles.root} ${props.className || ''} ${\n        props.busy ? styles.root_disabled : ''\n      }`}\n    >\n      <img\n        className={styles['root__magnifying-glass']}\n        src={magnifyingGlass.default}\n      ></img>\n      <input\n        className={styles.root__input}\n        type=\"text\"\n        value={props.text || ''}\n        onChange={props.onChange}\n        onKeyDown={e => {\n          if (e.key === 'Enter') props.onSubmit?.();\n        }}\n        role=\"search\"\n      ></input>\n      {/* {props.busy ? <Spin size=\"small\"></Spin> : undefined} */}\n    </div>\n  );\n};\n","import * as React from 'react';\n\nexport interface SelectOption {\n  value: string;\n  text: string;\n}\n\nexport interface SelectProps {\n  value?: string;\n  options: SelectOption[];\n  ariaLabel: string;\n  onChange?: (newValue: string) => unknown;\n}\n\nexport const SELECT_DEFAULT_VAL = 'SELECT_DEFAULT_VAL';\n\nexport const Select: React.FC<SelectProps> = React.memo(\n  (props: SelectProps) => {\n    return (\n      <select\n        className=\"form-select\"\n        aria-label={props.ariaLabel}\n        onChange={e => props.onChange?.(e.target.value)}\n        value={props.value || SELECT_DEFAULT_VAL}\n        // data-id={Date.now()}\n        role=\"listbox\"\n      >\n        {props.options.map(o => {\n          return (\n            <option value={o.value} key={o.value}>\n              {o.text}\n            </option>\n          );\n        })}\n        {props.value === undefined ? (\n          <option value={SELECT_DEFAULT_VAL}>Select</option>\n        ) : undefined}\n      </select>\n    );\n  },\n  (prev, next) => {\n    const t = prev.value === next.value;\n    return t;\n  },\n);\n\nSelect.displayName = `Memoizied Select`;\n","import * as React from 'react';\n\nimport styles from './skeleton.scss';\n\nexport const Skeleton: React.FC = () => {\n  return <div className={styles.root}></div>;\n};\n","import * as React from 'react';\n\nexport const SpinnerBorder: React.FC = () => {\n  return (\n    <div className=\"spinner-border text-light\" role=\"status\">\n      <span className=\"visually-hidden\">Loading...</span>\n    </div>\n  );\n};\n","import * as React from 'react';\n\nexport const SpinnerGrowing = () => {\n  return (\n    <div className=\"spinner-grow text-light\" role=\"status\">\n      <span className=\"visually-hidden\">Loading...</span>\n    </div>\n  );\n};\n","import * as React from 'react';\n\nexport interface TagSelectOption {\n  value: string;\n  text: string;\n}\n\nexport interface TagSelectProps {\n  value: string[];\n  options: TagSelectOption[];\n  'aria-label': string;\n  onChange?: (newValue: string[]) => unknown;\n}\n\nexport const TagSelect: React.FC<TagSelectProps> = (props: TagSelectProps) => {\n  return (\n    <div className=\"btn-group\" role=\"group\" aria-label={props['aria-label']}>\n      {props.options.map(option => {\n        const id = `${props['aria-label']}_${option.value}`;\n        const checked = props.value.includes(option.value);\n        return (\n          <React.Fragment key={option.value}>\n            <input\n              type=\"checkbox\"\n              className=\"btn-check\"\n              id={id}\n              autoComplete=\"off\"\n              checked={checked}\n              onChange={() =>\n                checked\n                  ? props.onChange?.(\n                      props.value.filter(v => v !== option.value),\n                    )\n                  : props.onChange?.([...props.value, option.value])\n              }\n              role=\"checkbox\"\n            ></input>\n            <label className=\"btn btn-outline-primary\" htmlFor={id}>\n              {option.text}\n            </label>\n          </React.Fragment>\n        );\n      })}\n    </div>\n  );\n};\n","import * as React from 'react';\n\nimport { SearchBar } from '../search-bar/search-bar';\nimport { WHCategories } from '../../../shared/wallheaven-types/categories';\nimport { WHPurities } from '../../../shared/wallheaven-types/purity';\nimport { WHSortings } from '../../../shared/wallheaven-types/sorting';\n// import { openPerPageChangeNotification } from '../../services/open-notification/open-notification';\n\nimport { WHPaginationData, WHQuery } from '../../defs';\n\nimport styles from './wh-search-box.scss';\nimport { TagSelect } from '../tag-select/tag-select';\nimport { Select } from '../select/select';\nimport { Pagination } from '../pagination/pagination';\nimport { BootstrapModal } from '../../lib/react/components/modals/bootstrap-modal';\nimport { genUniqId } from '../../lib/generators/generators';\nimport { DEFAULT_WH_PER_PAGE_VALUE } from '../../../shared/wallheaven-types/pagination';\n\nexport interface WHSearchBoxProps {\n  query: WHQuery;\n  onChange: (val: unknown, key: keyof WHQuery) => void;\n  onSubmit: () => void;\n  busy?: boolean;\n  pagination?: WHPaginationData;\n}\n\nexport const WHSearchBox: React.FC<WHSearchBoxProps> = (\n  props: WHSearchBoxProps,\n) => {\n  const [perPageError, setPerPageError] = React.useState(false);\n\n  return (\n    <div className={styles.root}>\n      <SearchBar\n        className={styles['root__search-bar']}\n        text={props.query.q}\n        onChange={e =>\n          props.onChange((e.target as HTMLInputElement).value, 'q')\n        }\n        onSubmit={() => props.onSubmit()}\n        busy={props.busy}\n      />\n      <div className={styles['root__ctls-box']}>\n        <div className={styles['root__parameters-box']}>\n          <div className={styles.root__parameter}>\n            {'Categories:'}\n            <TagSelect\n              value={props.query.categories}\n              aria-label={'Categories checkbox toogle button group'}\n              options={Object.keys(WHCategories).map(v => {\n                return { value: v, text: v };\n              })}\n              onChange={val => props.onChange(val, 'categories')}\n            />\n          </div>\n          <div className={styles.root__parameter}>\n            {'Purity:'}\n            <TagSelect\n              value={props.query.purity}\n              aria-label={'Purity checkbox toogle button group'}\n              options={Object.keys(WHPurities).map(v => {\n                return { value: v, text: v };\n              })}\n              onChange={val => props.onChange(val, 'purity')}\n            />\n          </div>\n          <label\n            className={styles.root__parameter}\n            style={{ fontSize: 'var(--bs-body-font-size)' }}\n          >\n            {'Sort by:'}\n            <Select\n              value={props.query.sorting}\n              ariaLabel=\"Sorting select\"\n              onChange={v => props.onChange(v, 'sorting')}\n              options={Object.keys(WHSortings).map(v => {\n                return { value: v, text: v };\n              })}\n            />\n          </label>\n          <label\n            className={styles.root__parameter}\n            style={{ fontSize: 'var(--bs-body-font-size)' }}\n          >\n            {'API key (is required to set items per page):'}\n            <input\n              className=\"form-control\"\n              placeholder=\"API key\"\n              value={props.query.apiKey || ''}\n              onChange={v => props.onChange(v.target.value, 'apiKey')}\n            />\n          </label>\n        </div>\n        <Pagination\n          disabled={props.busy}\n          current={props.pagination?.current_page}\n          total={props.pagination?.total}\n          perPage={Number.parseInt(\n            (props.pagination?.per_page || DEFAULT_WH_PER_PAGE_VALUE) as string,\n            10,\n          )}\n          onChange={v => props.onChange(v, 'page')}\n          onPerPageChange={v => setPerPageError(true)}\n          maxBtns={10}\n        />\n        {perPageError ? (\n          <BootstrapModal\n            id={genUniqId()}\n            classNameStr=\"animate__animated animate__fadeIn\"\n            ariaLabel=\"Settings change error\"\n            title=\"Settings change error\"\n            body=\"Wallhaven API doesn't allow to change items per page!\n                  You can do this in your profile settings.\n                  DO NOT FORGET TO ENTER YOUR API KEY AFTER THAT!\"\n            btnText=\"Go to settings\"\n            onClose={() => setPerPageError(false)}\n            onOk={() => {\n              setPerPageError(false);\n              const a = document.createElement('a');\n              a.href = 'https://wallhaven.cc/settings/account';\n              a.target = '_blank';\n              a.referrerPolicy = 'noreferrer';\n              a.click();\n            }}\n          />\n        ) : undefined}\n      </div>\n    </div>\n  );\n};\n","import { OBJ_PROCESSOR } from './lib/processors/obj-processor';\nimport {\n  WHCategories,\n  WHCategoriesList,\n} from '../shared/wallheaven-types/categories';\nimport { WHPerPageValue } from '../shared/wallheaven-types/pagination';\nimport { WHPurities, WHPurityList } from '../shared/wallheaven-types/purity';\nimport { WHSorting, WHSortings } from '../shared/wallheaven-types/sorting';\nimport { WHSearchDataItem } from '../shared/wallheaven-types/wh-search-data';\n\n// export type ReactHookSetter<T> = React.Dispatch<React.SetStateAction<T>>;\n\n// export type WHImageEssentialData = {\n//   id: string;\n//   src?: string;\n//   loadSuccess?: boolean;\n//   path?: string;\n// };\n\nexport interface WHSearchDataItemWithLifecycle extends WHSearchDataItem {\n  loadSuccess?: boolean;\n}\n\nexport class WHQuery {\n  constructor(\n    public q: string,\n    public categories: WHCategoriesList,\n    public purity: WHPurityList,\n    public sorting: WHSorting,\n    public page: number,\n    public apiKey?: string,\n  ) {}\n}\n\nexport type WHPaginationData = {\n  current_page: number;\n  last_page: number;\n  per_page: WHPerPageValue;\n  total: number;\n};\n\nexport const DEFALUT_WHQUERY = OBJ_PROCESSOR.deepFreeze(\n  new WHQuery(\n    '',\n    [WHCategories.general],\n    [WHPurities.sfw],\n    WHSortings.date_added,\n    1,\n  ),\n);\n\nexport const API_URL = 'http://localhost:9000/proxy';\n","const randomFunc = (): string =>\n  window.crypto?.getRandomValues\n    ? window.crypto.getRandomValues(new Uint8Array(4)).join('')\n    : Array(8)\n        .fill(null)\n        .map(() => (Math.random() * 10).toFixed(0))\n        .join('');\n\nexport function genUniqId(): string {\n  return randomFunc();\n}\n\nexport function getRandomInt(max: number): number {\n  return Math.floor(Math.random() * max);\n}\n\nexport function getRandomArbitraryInt(min: number, max: number): number {\n  return Math.floor(Math.random() * (max - min) + min);\n}\n\nexport function genRandomHexColor(): string {\n  const color = `#${Math.floor(Math.random() * 16_777_215).toString(16)}`;\n  if (color.length === 7) return color;\n  return genRandomHexColor();\n}\n\nexport function gen2DArray(rows: number, columns: number): unknown[][] {\n  const x = new Array(rows);\n  for (let i = 0; i < rows; i++) {\n    x[i] = new Array(columns);\n  }\n  return x;\n}\n","export type QueueItem<T> = {\n  action: () => Promise<T>;\n  res: (result: T) => void;\n  rej: (reason?: Error) => void;\n  next?: QueueItem<T>;\n  number: number;\n};\n\nexport type ThrottlerFunc = (\n  reqPerWindow: number,\n  firstTimeInWindow: number,\n) => Promise<void>;\n\nexport class QueueManager<T> {\n  private lastQueued: QueueItem<T> | undefined;\n\n  private timestamps: number[] = [];\n\n  constructor(\n    private throttler?: ThrottlerFunc,\n    private throttlerTimeWindow = 1000,\n  ) {}\n\n  do(action: () => Promise<T>): Promise<T> {\n    return new Promise<T>((res, rej) => {\n      const item: QueueItem<T> = { action, res, rej, number: 0 };\n\n      if (this.lastQueued) {\n        this.lastQueued.next = item;\n        item.number = this.lastQueued.number + 1;\n        this.lastQueued = item;\n      } else {\n        this.lastQueued = item;\n        this.processItem(item);\n      }\n    });\n  }\n\n  private throttleReq() {\n    if (!this.throttler) return Promise.resolve();\n    return new Promise<void>(res => {\n      const last = Date.now();\n      this.timestamps.push(last);\n      const cutoff = last - this.throttlerTimeWindow;\n      this.timestamps = this.timestamps.filter(t => t > cutoff);\n      (this.throttler as ThrottlerFunc)(\n        this.timestamps.length,\n        this.timestamps[0] || 0,\n      ).then(() => res());\n    });\n  }\n\n  private processItem(item: QueueItem<T>) {\n    this.throttleReq().then(() => {\n      item\n        .action()\n        .then(result => item.res(result))\n        .catch(err => item.rej(err))\n        .finally(() => {\n          if (item.next) this.processItem(item.next as QueueItem<T>);\n          else this.lastQueued = undefined;\n        });\n    });\n  }\n}\n","class ObjProcessor {\n  readonly deepFreeze = <T>(obj: T): T => {\n    if (typeof obj === 'object' && obj !== null) {\n      const record = obj as Record<string, unknown>;\n      Object.keys(record).forEach(prop => {\n        if (\n          typeof record[prop] === 'object' &&\n          !Object.isFrozen(record[prop])\n        ) {\n          this.deepFreeze(record[prop]);\n        }\n      });\n      return Object.freeze(obj);\n    }\n    throw new Error('not object');\n  };\n\n  readonly deepClone = <T>(target: T): T => {\n    if (Array.isArray(target)) {\n      const clone = [] as unknown[];\n      (target as unknown[]).forEach(v => {\n        clone.push(v);\n      });\n      return clone.map((n: unknown) => this.deepClone(n)) as unknown as T;\n    }\n\n    if (typeof target === 'object' && target !== null) {\n      if (target instanceof Date)\n        return new Date(target.getTime()) as unknown as T;\n      if (target instanceof HTMLElement)\n        return target.cloneNode(true) as unknown as T;\n      if (target instanceof Blob) return target.slice() as unknown as T;\n      const clone = {\n        ...(target as unknown as { [key: string]: unknown }),\n      } as {\n        [key: string]: unknown;\n      };\n      Object.keys(clone).forEach(k => {\n        clone[k] = this.deepClone(clone[k]);\n      });\n      Object.setPrototypeOf(clone, Object.getPrototypeOf(target));\n      return clone as unknown as T;\n    }\n    return target;\n  };\n\n  readonly deepCloneForWebworker = <T>(target: T): T => {\n    if (Array.isArray(target)) {\n      const clone = [] as unknown[];\n      (target as unknown[]).forEach(v => {\n        clone.push(v);\n      });\n      return clone.map((n: unknown) =>\n        this.deepCloneForWebworker(n),\n      ) as unknown as T;\n    }\n\n    if (typeof target === 'object' && target !== null) {\n      const clone = {\n        ...(target as unknown as { [key: string]: unknown }),\n      } as {\n        [key: string]: unknown;\n      };\n      Object.keys(clone).forEach(k => {\n        clone[k] = this.deepCloneForWebworker(clone[k]);\n      });\n      // Object.setPrototypeOf(clone, Object.getPrototypeOf(target));\n      return clone as unknown as T;\n    }\n    return target;\n  };\n}\n\nconst OBJ_PROCESSOR = new ObjProcessor();\nOBJ_PROCESSOR.deepFreeze(OBJ_PROCESSOR);\nexport { OBJ_PROCESSOR };\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nexport interface BootstrapModalProps {\n  id: string;\n  ariaLabel: string;\n  onClose: () => unknown;\n  title: string;\n  body: string;\n  btnText: string;\n  onOk: () => unknown;\n  classNameStr?: string;\n}\n\nexport const BootstrapModal: React.FC<BootstrapModalProps> = (\n  props: BootstrapModalProps,\n) => {\n  const target = document.body;\n  const anchor = document.createElement('div');\n\n  React.useEffect(() => {\n    target.append(anchor);\n    return () => anchor.remove();\n  }, []);\n\n  return ReactDOM.createPortal(\n    <div\n      className={`modal fade show ${props.classNameStr || ''}`}\n      id={props.id}\n      tabIndex={-1}\n      aria-labelledby={props.ariaLabel}\n      style={{ display: 'block' }}\n      // onClick={() => props.onClose()}\n      onClick={() => props.onClose()}\n      // aria-hidden=\"true\"\n      role=\"dialog\"\n    >\n      <div className=\"modal-dialog\" onClick={e => e.stopPropagation()}>\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <h5 className=\"modal-title\">{props.title}</h5>\n            <button\n              type=\"button\"\n              className=\"btn-close\"\n              data-bs-dismiss=\"modal\"\n              aria-label=\"Close\"\n              onClick={() => props.onClose()}\n              role=\"button\"\n            ></button>\n          </div>\n          <div className=\"modal-body\">{props.body}</div>\n          <div className=\"modal-footer\">\n            <button\n              type=\"button\"\n              className=\"btn btn-secondary\"\n              data-bs-dismiss=\"modal\"\n              onClick={() => props.onClose()}\n              role=\"button\"\n            >\n              Close\n            </button>\n            <button\n              type=\"button\"\n              className=\"btn btn-primary\"\n              onClick={() => props.onOk()}\n              role=\"button\"\n            >\n              {props.btnText}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>,\n\n    anchor,\n  );\n};\n","import * as React from 'react';\n\nexport interface BsObjTableProps {\n  obj: Record<string, unknown>;\n  header: string;\n}\n\nexport const BsObjTable: React.FC<BsObjTableProps> = (\n  props: BsObjTableProps,\n): JSX.Element => {\n  return (\n    <table className=\"table\">\n      <thead>\n        <tr>\n          <th colSpan={9999}>{props.header}</th>\n        </tr>\n      </thead>\n      <tbody>\n        {Object.entries(props.obj).map(entry => {\n          const [key, val] = entry;\n\n          if (typeof val === 'object' && val !== null) {\n            const newProps: BsObjTableProps = {\n              obj: val as Record<string, unknown>,\n              header: key,\n            };\n            return (\n              <tr key={key}>\n                <td colSpan={9999}>{BsObjTable(newProps)}</td>\n              </tr>\n            );\n          }\n          return (\n            <tr key={key}>\n              <th scope=\"col\">{key}</th>\n              <th scope=\"col\">{val as string}</th>\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  );\n};\n","import { QueueManager } from '../../lib/misc/queue-manager';\n\nexport class ImgFetcher {\n  private IMG_LOAD_QUEUE_MANAGER = new QueueManager<boolean>(\n    async (reqPerWindow: number, firstTimeInWindow: number) => {\n      const throttleTime =\n        reqPerWindow >= this.REQ_PER_WINDOW\n          ? this.WINDOW - (Date.now() - firstTimeInWindow)\n          : 0;\n      await new Promise(res => setTimeout(res, throttleTime));\n    },\n    this.WINDOW,\n  );\n\n  constructor(public REQ_PER_WINDOW: number, public WINDOW: number) {}\n\n  loadImg = (src: string): Promise<boolean> => {\n    const action = async () => {\n      if (!src) return false;\n      return new Promise<boolean>(res => {\n        const img = new Image();\n        img.onload = () => res(true);\n        img.onerror = () => res(false);\n\n        // setTimeout(() => {\n        img.referrerPolicy = 'no-referrer'; // !\n        console.log(src);\n        img.src = src;\n        // }, 10000);\n      });\n    };\n    return this.IMG_LOAD_QUEUE_MANAGER.do(action);\n  };\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { CSSTransition } from 'react-transition-group';\n\nimport { genUniqId } from '../../lib/generators/generators';\nimport { BootstrapModal } from '../../lib/react/components/modals/bootstrap-modal';\n\nexport const openNSFWNotification = () => {\n  const div = document.createElement('div');\n  // document.body.append(div);\n  const onClose = () => {\n    ReactDOM.render(<></>, div);\n    div.remove();\n  };\n  const elem = (\n    <BootstrapModal\n      classNameStr=\"animate__animated animate__fadeIn\"\n      id={genUniqId()}\n      ariaLabel=\"Settings change error\"\n      title=\"Settings change error\"\n      body=\"Wallhaven requires API key for NSFW content!\n            Copy your API key and enter it first!\n            DO NOT FORGET TO ALLOW NSFW IN RESULTS IN ACCOUNT SETTINGS!\"\n      btnText=\"Go to settings\"\n      onClose={() => onClose()}\n      onOk={() => {\n        onClose();\n        const a = document.createElement('a');\n        a.href = 'https://wallhaven.cc/settings/account';\n        a.target = '_blank';\n        a.referrerPolicy = 'noreferrer';\n        a.click();\n      }}\n    />\n  );\n  ReactDOM.render(elem, div);\n};\n","import { API_URL, WHPaginationData, WHQuery } from '../../defs';\nimport { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\nimport { WHCategoriesList } from '../../../shared/wallheaven-types/categories';\nimport { WHPurityList } from '../../../shared/wallheaven-types/purity';\nimport { WHSorting } from '../../../shared/wallheaven-types/sorting';\nimport {\n  WHSearchDataItem,\n  WHSearchResponse,\n} from '../../../shared/wallheaven-types/wh-search-data';\nimport { openNSFWNotification } from '../open-notification/open-notification';\nimport { ProxyReqCodes } from '../../../shared/proxy.def';\n\nexport type WHResponseProcessed = {\n  data: Record<string, WHSearchDataItem>;\n  loads: Promise<[string, boolean]>[];\n  pagination: WHPaginationData;\n};\n\nconst calcCategoryQuery = (query: WHQuery): string => {\n  const general = query.categories.includes('general') ? 1 : 0;\n  const anime = query.categories.includes('anime') ? 1 : 0;\n  const people = query.categories.includes('people') ? 1 : 0;\n  return `${general}${anime}${people}`;\n};\n\nconst calcPurityQuery = (query: WHQuery): string => {\n  const sfw = query.purity.includes('sfw') ? 1 : 0;\n  const sketchy = query.purity.includes('sketchy') ? 1 : 0;\n  const nsfw = query.purity.includes('nsfw') ? 1 : 0;\n  return `${sfw}${sketchy}${nsfw}`;\n};\n\nexport const calcWHQueryStr = (query: WHQuery): string => {\n  const { q } = query;\n  const categories = calcCategoryQuery(query);\n  const purity = calcPurityQuery(query);\n  const filtersStr = `&categories=${categories}&purity=${purity}`;\n  const apiKeyStr = query.apiKey ? `&apikey=${query.apiKey}` : '';\n  const pageStr = `&page=${query.page}`;\n  return `search?q=${q}${filtersStr}&sorting=${query.sorting}${pageStr}${apiKeyStr}`;\n};\n\nexport const modQuery = (\n  query: WHQuery,\n  key: keyof WHQuery,\n  val: unknown,\n): WHQuery => {\n  const newQuery = OBJ_PROCESSOR.deepClone(query);\n  if (key === 'q') newQuery[key] = val as string;\n  else if (key === 'categories') newQuery[key] = val as WHCategoriesList;\n  else if (key === 'purity') {\n    if (\n      (val as WHPurityList).includes('nsfw') &&\n      (!query.apiKey || query.apiKey === '')\n    ) {\n      openNSFWNotification();\n    } else newQuery[key] = val as WHPurityList;\n  } else if (key === 'sorting') newQuery[key] = val as WHSorting;\n  else if (key === 'page') {\n    const int = Number.parseInt(`${val}`, 10);\n    if (!Number.isNaN(int)) newQuery[key] = int;\n  } else if (key === 'apiKey') {\n    newQuery[key] = val as string;\n    if (val === '' && query.purity.includes('nsfw'))\n      newQuery.purity = query.purity.filter(item => item !== 'nsfw');\n  }\n  return newQuery;\n};\n\nconst HTTP_REQ_INIT: RequestInit | undefined =\n  process.env.NODE_ENV === 'test'\n    ? {\n        referrerPolicy: 'no-referrer',\n        headers: {\n          Origin: 'http://localhost:8080',\n        },\n      }\n    : undefined;\n\nexport const getWHSearch = (\n  query: WHQuery,\n): Promise<[Record<string, WHSearchDataItem>, WHPaginationData]> => {\n  return new Promise<[Record<string, WHSearchDataItem>, WHPaginationData]>(\n    (res, rej) => {\n      const fetchStr = calcWHQueryStr(query);\n      fetch(API_URL, {\n        ...HTTP_REQ_INIT,\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ code: ProxyReqCodes.WHSearch, fetchStr }),\n      })\n        .then(response => {\n          if (response.ok) return response.json();\n          throw new Error('x');\n        })\n        .then(json => {\n          const obj = json as WHSearchResponse;\n          const dataObj: Record<string, WHSearchDataItem> = {};\n          obj.data.forEach(it => {\n            dataObj[it.id] = it;\n          });\n          const pagination: WHPaginationData = {\n            current_page: obj.meta.current_page,\n            last_page: obj.meta.last_page,\n            total: obj.meta.total,\n            per_page: obj.meta.per_page,\n          };\n          res([dataObj, pagination]);\n        })\n        .catch(e => rej(e));\n    },\n  );\n};\n","import { Action } from 'redux';\nimport { Actions } from '../actions.d';\n\nexport interface SetApiKeyAction extends Action {\n  payload: string | undefined;\n}\n\nexport const setApiKey = (apiKey: string | undefined): SetApiKeyAction => {\n  return {\n    type: Actions.CORE_SET_API_KEY,\n    payload: apiKey,\n  };\n};\n","import { Dispatch } from 'redux';\nimport { API_URL } from '../../../defs';\nimport { WHWallpaperData } from '../../../../shared/wallheaven-types/wh-wallpaper-data';\nimport { State } from '../../state';\nimport { setData } from './setData';\nimport { setFlag } from './setFlag';\nimport { ProxyReqCodes } from '../../../../shared/proxy.def';\n\nexport const fetchById = (id: string) => {\n  return (dispatch: Dispatch, getState: () => State): void => {\n    const { apiKey, imgFetcher } = getState().coreState;\n    fetch(API_URL, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ code: ProxyReqCodes.WHWpInfo, id, apiKey }),\n    })\n      .then(response => {\n        if (response.ok) return response.json();\n        throw new Error('');\n      })\n      .then(json => {\n        const data = json.data as WHWallpaperData;\n        dispatch(setData(data));\n        console.log(data);\n        imgFetcher.loadImg(data.path).then(result => {\n          console.log(result);\n          // setTimeout(() => {\n          dispatch(setFlag('imgPreloaded', result));\n          // }, 2000);\n        });\n        dispatch(setFlag('dataLoaded', true));\n      })\n      .catch(err => {\n        console.log(err);\n        dispatch(setFlag('dataLoaded', false));\n      });\n  };\n};\n","import { Action } from 'redux';\nimport { Actions } from '../actions.d';\n\nexport const resetDetailsPageState = (): Action => {\n  return {\n    type: Actions.DETAILS_PAGE_RESET,\n  };\n};\n","import { Action } from 'redux';\nimport { WHWallpaperData } from '../../../../shared/wallheaven-types/wh-wallpaper-data';\nimport { Actions } from '../actions.d';\n\nexport interface SetDetailsPageDataAction extends Action {\n  payload: WHWallpaperData | undefined;\n}\n\nexport const setData = (\n  data: WHWallpaperData | undefined,\n): SetDetailsPageDataAction => {\n  return {\n    type: Actions.DETAILS_PAGE_SET_DATA,\n    payload: data,\n  };\n};\n","import { Action } from 'redux';\nimport { DetailsPageFlag } from '../../initials/detailsPageFlag';\nimport { Actions } from '../actions.d';\n\nexport interface SetDetailsPageFlagAction extends Action {\n  payload: { key: DetailsPageFlag; val: boolean };\n}\n\nexport const setFlag = (\n  key: DetailsPageFlag,\n  val: boolean,\n): SetDetailsPageFlagAction => {\n  return {\n    type: Actions.DETAILS_PAGE_SET_FLAG,\n    payload: { key, val },\n  };\n};\n","import { Dispatch } from 'redux';\nimport { WHQuery } from '../../../defs';\nimport {\n  getWHSearch,\n  WHResponseProcessed,\n} from '../../../services/wh-api/wh-client-api';\nimport { State } from '../../state';\nimport { setData } from './setData';\nimport { setFlag } from './setFlag';\nimport { setPagination } from './setPagination';\n\n// const loadDataFunc: (\n//   query: WHQuery,\n// ) => Promise<[Record<string, WHSearchDataItem>, WHPaginationData]> =\n//   // loadFakeData;\n//   process.env.NODE_ENV === 'test' ? loadFakeData : loadDataFromWH;\n\nconst setTestLoadResultFunc: (result: boolean) => boolean =\n  process.env.NODE_ENV === 'test'\n    ? (result: boolean) => true\n    : (result: boolean) => result;\n\nconst loadData = async (\n  query: WHQuery,\n  loadImgFunc: (str: string) => Promise<boolean>,\n): Promise<WHResponseProcessed> => {\n  const [data, pagination] = await getWHSearch(query);\n  const loads = Object.entries(data).map(entry => {\n    return new Promise<[string, boolean]>(res => {\n      if (!entry[1].thumbs.small)\n        res([entry[1].id, setTestLoadResultFunc(false)]);\n      else {\n        loadImgFunc(entry[1].thumbs.small).then(result => {\n          res([entry[1].id, setTestLoadResultFunc(result)]);\n        });\n      }\n    });\n  });\n  return { data, loads, pagination };\n};\n\nexport const FetchSearch = (more: boolean, specQuery?: WHQuery) => {\n  return (dispatch: Dispatch, getState: () => State): void => {\n    const state = getState();\n    const { loadImg } = state.coreState.imgFetcher;\n    const { flags } = state.galleryState;\n    const query = specQuery || state.galleryState.query;\n    if (flags.fetching || (more && flags.end)) return;\n\n    dispatch(setFlag('error', false));\n    dispatch(setFlag('fetching', true));\n    dispatch(setFlag('searchPerformed', true));\n\n    if (!more) {\n      dispatch(setFlag('end', false));\n      dispatch(setData({}));\n    } else query.page++;\n\n    loadData(query, loadImg)\n      .then(async response => {\n        const newDataMap = more\n          ? { ...state.galleryState.dataMap, ...response.data }\n          : response.data;\n        dispatch(setData(newDataMap));\n        dispatch(setPagination(response.pagination));\n        dispatch(setFlag('fetching', false));\n        if (\n          response.loads.length === 0 ||\n          response.pagination.last_page === response.pagination.current_page\n        ) {\n          dispatch(setFlag('end', true));\n        }\n        response.loads.forEach(load => {\n          load.then(result => {\n            const [id, loadSuccess] = result;\n            const currState = getState().galleryState;\n            if (currState.dataMap[id]) {\n              currState.dataMap[id].loadSuccess = loadSuccess;\n              dispatch(setData(currState.dataMap));\n            }\n          });\n        });\n      })\n      .catch(() => {\n        dispatch(setFlag('fetching', false));\n        dispatch(setFlag('end', true));\n        dispatch(setFlag('error', true));\n      });\n  };\n};\n","import { Action } from 'redux';\nimport { Actions } from '../actions.d';\n\nexport interface SetContentScrollTopAction extends Action {\n  payload: number;\n}\n\nexport const setContentScrollTop = (val: number): SetContentScrollTopAction => {\n  return {\n    type: Actions.GALLERY_SET_CONTENT_SCROLL_TOP,\n    payload: val,\n  };\n};\n","import { Action } from 'redux';\nimport { WHSearchDataItemWithLifecycle } from '../../../defs';\nimport { Actions } from '../actions.d';\n\nexport interface SetDataAction extends Action {\n  payload: Record<string, WHSearchDataItemWithLifecycle>;\n}\n\nexport const setData = (\n  data: Record<string, WHSearchDataItemWithLifecycle>,\n): SetDataAction => {\n  return {\n    type: Actions.GALLERY_SET_DATA,\n    payload: data,\n  };\n};\n","import { Action } from 'redux';\nimport { GalleryFlags } from '../../initials/galleryState';\nimport { Actions } from '../actions.d';\n\nexport interface SetFlagAction extends Action {\n  payload: { key: GalleryFlags; val: boolean };\n}\n\nexport const setFlag = (key: GalleryFlags, val: boolean): SetFlagAction => {\n  return {\n    type: Actions.GALLERY_SET_FLAG,\n    payload: { key, val },\n  };\n};\n","import { Action } from 'redux';\nimport { WHPaginationData } from '../../../defs';\nimport { Actions } from '../actions.d';\n\nexport interface SetPaginationAction extends Action {\n  payload: WHPaginationData;\n}\n\nexport const setPagination = (data: WHPaginationData): SetPaginationAction => {\n  return {\n    type: Actions.GALLERY_SET_PAGINATION,\n    payload: data,\n  };\n};\n","import { Action } from 'redux';\nimport { WHQuery } from '../../../defs';\nimport { Actions } from '../actions.d';\n\nexport interface SetQueryAction extends Action {\n  payload: WHQuery;\n}\n\nexport const setQuery = (query: WHQuery): SetQueryAction => {\n  return {\n    type: Actions.GALLERY_SET_QUERY,\n    payload: query,\n  };\n};\n","import { ImgFetcher } from '../../services/img-fetcher/img-fetcher';\nimport { CoreState } from '../state';\n\nconst WALLHAVEN_WINDOW = 60000;\nconst WALLHAVEN_REQ_PER_WINDOW = 700; // ! in fact 45 req per min for API, for images I don't know...\n\nexport const CORE_INITIAL_STATE: CoreState = {\n  apiKey: undefined,\n  imgFetcher: new ImgFetcher(WALLHAVEN_REQ_PER_WINDOW, WALLHAVEN_WINDOW),\n};\n","import { DetailsPageState } from '../state';\n\nexport const DETAILS_PAGE_INIT_STATE: DetailsPageState = {\n  data: undefined,\n  flags: {\n    dataLoaded: undefined,\n    imgPreloaded: undefined,\n  },\n};\n\nexport type DetailsPageFlag = keyof typeof DETAILS_PAGE_INIT_STATE.flags;\n","import { DEFALUT_WHQUERY } from '../../defs';\nimport { GalleryState } from '../state';\n\nexport const GALLERY_INITIAL_STATE: GalleryState = {\n  query: DEFALUT_WHQUERY,\n  dataMap: {},\n  paginationData: undefined,\n  contentScrollTop: 0,\n  flags: {\n    fetching: false,\n    error: false,\n    searchPerformed: false,\n    end: true,\n  },\n};\n\nexport type GalleryFlags = keyof typeof GALLERY_INITIAL_STATE.flags;\n","import fetch from 'node-fetch';\n\nimport { DEFAULT_WH_PER_PAGE_VALUE } from '../shared/wallheaven-types/pagination';\n\nimport {\n  WHSearchDataItem,\n  WHSearchMeta,\n  WHSearchResponse,\n} from '../shared/wallheaven-types/wh-search-data';\nimport { WHWallpaperData } from '../shared/wallheaven-types/wh-wallpaper-data';\nimport { WHWpInfoProxyReq, WHSearchProxyReq } from './wh-server-api.def';\n\nconst WH_API_BASE_STR = 'https://wallhaven.cc/api/v1/';\n\n/* --- GET ONE WALLPAPER --- */\n\nexport const getWHWallpaer = (\n  req: WHWpInfoProxyReq,\n): Promise<WHWallpaperData> => {\n  return new Promise((res, rej) => {\n    fetch(`${WH_API_BASE_STR}w/${req.id}${req.apiKey ? `?${req.apiKey}` : ''}`)\n      .then(response => {\n        if (response.status !== 200) throw new Error(response.statusText);\n        else return response.json();\n      })\n      .then(json => res(json.data as WHWallpaperData))\n      .catch(err => rej(err));\n  });\n};\n\n/* --- FAKE --- */\n\nconst fakeImgSrc = '/public/test-image.jpg';\n\nexport const getWHWallpaperFake = (): Promise<WHWallpaperData> => {\n  return new Promise(res => {\n    const fake = {\n      id: '94x38z',\n      url: 'https://wallhaven.cc/w/94x38z',\n      short_url: 'http://whvn.cc/94x38z',\n      uploader: {\n        username: 'test-user',\n        group: 'User',\n        avatar: {\n          '200px':\n            'https://wallhaven.cc/images/user/avatar/200/11_3339efb2a813.png',\n          '128px':\n            'https://wallhaven.cc/images/user/avatar/128/11_3339efb2a813.png',\n          '32px':\n            'https://wallhaven.cc/images/user/avatar/32/11_3339efb2a813.png',\n          '20px':\n            'https://wallhaven.cc/images/user/avatar/20/11_3339efb2a813.png',\n        },\n      },\n      views: 12,\n      favorites: 0,\n      source: '',\n      purity: 'sfw',\n      category: 'anime',\n      dimension_x: 6742,\n      dimension_y: 3534,\n      resolution: '6742x3534',\n      ratio: '1.91',\n      file_size: 5070446,\n      file_type: 'image/jpeg',\n      created_at: '2018-10-31 01:23:10',\n      colors: ['#000000', '#abbcda', '#424153', '#66cccc', '#333399'],\n      path: 'https://w.wallhaven.cc/full/94/wallhaven-94x38z.jpg',\n      thumbs: {\n        large: 'https://th.wallhaven.cc/lg/94/94x38z.jpg',\n        original: 'https://th.wallhaven.cc/orig/94/94x38z.jpg',\n        small: 'https://th.wallhaven.cc/small/94/94x38z.jpg',\n      },\n      tags: [\n        {\n          id: 1,\n          name: 'anime',\n          alias: 'Chinese cartoons',\n          category_id: 1,\n          category: 'Anime & Manga',\n          purity: 'sfw',\n          created_at: '2015-01-16 02:06:45',\n        },\n      ],\n    };\n    // throw new Error('');\n    // setTimeout(() => {\n    res({ ...fake, path: fakeImgSrc } as WHWallpaperData);\n    // }, 5000);\n  });\n};\n\n/* ---/// FAKE --- */\n\n/* --- /// GET ONE WALLPAPER --- */\n\n/* --- GET WH SEARCH RESULT --- */\n\nexport const getWHSearch = (\n  req: WHSearchProxyReq,\n): Promise<WHSearchResponse> => {\n  return new Promise((res, rej) => {\n    fetch(`${WH_API_BASE_STR}${req.fetchStr}`)\n      .then(response => {\n        if (response.status !== 200) throw new Error(response.statusText);\n        else return response.json();\n      })\n      .then(json => res(json))\n      .catch(err => rej(err));\n  });\n};\n\n/* --- FAKE --- */\n\nconst FAKE_PREVIEW_SRC = '/public/test-preview.jpg';\nconst FAKE_ITEMS_COUNT = 24;\n\nconst genFakeData = (page: number): WHSearchResponse => {\n  const fakeData = Array(FAKE_ITEMS_COUNT)\n    .fill(null)\n    .map(() => {\n      return {\n        id: Math.random() * 1000, // ! Create true node random with crypto!\n        thumbs: {\n          small: FAKE_PREVIEW_SRC,\n        },\n        path: FAKE_PREVIEW_SRC,\n        loadSuccess: undefined,\n      } as unknown as WHSearchDataItem;\n    });\n\n  const fakeMeta = {\n    current_page: page,\n    total: FAKE_ITEMS_COUNT * 100,\n    last_page: 100,\n    per_page: DEFAULT_WH_PER_PAGE_VALUE,\n  } as WHSearchMeta;\n\n  return { data: fakeData, meta: fakeMeta };\n};\n\nexport const getWHSearchFake = async (\n  req: WHSearchProxyReq,\n): Promise<WHSearchResponse> => {\n  const url = new URLSearchParams(req.fetchStr);\n  if (url.get('q') === 'ERROR') throw new Error();\n  const page = url.get('page');\n  const fakeResponse = genFakeData(page ? +page : 1);\n  return fakeResponse;\n};\n\n/* ---/// FAKE --- */\n\n/* ---/// GET WH SEARCH RESULT --- */\n","export enum ProxyReqCodes {\n  'WHSearch',\n  'WHWpInfo',\n}\n","import { OBJ_PROCESSOR } from '../../client/lib/processors/obj-processor';\n\nclass WHCategoriesClass {\n  readonly 'general' = 'general';\n\n  readonly 'anime' = 'anime';\n\n  readonly 'people' = 'people';\n}\n\nexport const WHCategories = OBJ_PROCESSOR.deepFreeze(new WHCategoriesClass());\n\nexport type WHCategoriesList = (keyof WHCategoriesClass)[];\n","import { OBJ_PROCESSOR } from '../../client/lib/processors/obj-processor';\n\nclass WHPerPageValuesClass {\n  readonly '24' = '24';\n\n  readonly '32' = '32';\n\n  readonly '64' = '64';\n}\n\nexport const WHPerPageValues = OBJ_PROCESSOR.deepFreeze(\n  new WHPerPageValuesClass(),\n);\n\nexport type WHPerPageValue = keyof WHPerPageValuesClass;\n\nexport const DEFAULT_WH_PER_PAGE_VALUE: WHPerPageValue = '24';\n","import { OBJ_PROCESSOR } from '../../client/lib/processors/obj-processor';\n\nclass WHPurityClass {\n  readonly 'sfw' = 'sfw';\n\n  readonly 'sketchy' = 'sketchy';\n\n  readonly 'nsfw' = 'nsfw';\n}\n\nexport const WHPurities = OBJ_PROCESSOR.deepFreeze(new WHPurityClass());\n\nexport type WHPurityList = (keyof WHPurityClass)[];\n","import { OBJ_PROCESSOR } from '../../client/lib/processors/obj-processor';\n\nclass WHSortingClass {\n  readonly 'date_added' = 'date_added';\n\n  readonly 'relevance' = 'relevance';\n\n  readonly 'random' = ' random';\n\n  readonly 'views' = ' views';\n\n  readonly 'favorites' = 'favorites';\n\n  readonly 'toplist' = 'toplist';\n}\n\nexport const WHSortings = OBJ_PROCESSOR.deepFreeze(new WHSortingClass());\n\nexport type WHSorting = keyof WHSortingClass;\n","export default __webpack_public_path__ + \"assets/img/527a47952219a8b48cb8f8965516ec60.png\";","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"MKu2YWXstrQJ1Z3-dKL12\",\"root__article\":\"_3vUfVlSwXwWoTOSNe9YGht\"};","// extracted by mini-css-extract-plugin\nexport default {\"app\":\"_20nxk27raIoQOMCaRqzCMI\",\"route\":\"hPVezq9jv-2RfgmAvohDm\",\"route_enter\":\"_1XJfMn_82ysnUdovTymyQ\",\"route_enter-active\":\"_1Kg3rK0PBZc56Lq-tD6YRo\",\"route_exit\":\"_3zQSOu0GtMHwzUmLb_mk5i\",\"route_exit-active\":\"ECmgixBmO0TAH4lQzAetf\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"hpADCA_u6ByhFe3eUE4np\",\"root__cards\":\"sTplLDxN8N8RSiX-Hm5No\",\"root__spinner-box\":\"_3PLYaeN9ff0CajZ8RvGx3N\",\"content-item_plug\":\"_2eAVE3-Vj7Ha40M_L7PRD_\",\"fade-in\":\"_2TBUHHAVOWIaiQ8wnWEsiZ\",\"content-item_Image\":\"_30XHoCw1lsxYi7WsCBLsba\",\"content-item__wrapper\":\"_3HuZetPlbdnXKCfklN3CDj\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_2ipSUfV-4BIzPS6WOMDYPg\",\"root__aside\":\"Fp06vNgioy9buCDlGdsxa\",\"root__content\":\"_1W9wIWfyrVDFxDbzHsr0ix\",\"root__btn-backward\":\"_2Oe67rCIiPAxMAxs2DtXCb\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"vxTsoN8CBwcmhUrUuuIpL\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_2Yjl-1w1HRNhRwWvRQMLiP\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"KUwDQ7O-sB08SgJCv6JUG\",\"root__magnifying-glass\":\"_3JVX9kPM8m-7z1SkrtdKtJ\",\"root__input\":\"QLXkaPi43BFkwA7XAmatM\",\"root_disabled\":\"_31DhKG5dZf0ks4ROrZ3qvh\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_3PuaPu4R1qfCqyo6ZxG1z8\",\"background-shift\":\"thTdFIJSRpY9yFpkIQmRn\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_2BsgEMe1LEX0iJ7bgZata1\",\"root__search-bar\":\"_3kURvWdSNN7HxQEbkY8d24\",\"root__ctls-box\":\"_201RsWi2Dy4UaSgMFpInMw\",\"root__parameters-box\":\"_9TxdnNqBo5njSlnboTCt_\",\"root__parameter\":\"_1wt5p4j1mCgxzzx4wwqN8f\"};","module.exports = require(\"body-parser\");","module.exports = require(\"core-js/stable\");","module.exports = require(\"express\");","module.exports = require(\"fs\");","module.exports = require(\"node-fetch\");","module.exports = require(\"path\");","module.exports = require(\"react\");","module.exports = require(\"react-dom\");","module.exports = require(\"react-dom/server\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-router\");","module.exports = require(\"react-router-dom\");","module.exports = require(\"react-transition-group\");","module.exports = require(\"react/jsx-dev-runtime\");","module.exports = require(\"redux\");","module.exports = require(\"regenerator-runtime/runtime\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","import 'core-js/stable';\nimport 'regenerator-runtime/runtime';\n\nimport * as React from 'react';\nimport * as ReactDOMServer from 'react-dom/server';\n\nimport * as Express from 'express';\nimport { StaticRouter } from 'react-router';\nimport { createStore } from 'redux';\nimport { Provider } from 'react-redux';\nimport { State } from '../client/store/state';\nimport { GALLERY_INITIAL_STATE } from '../client/store/initials/galleryState';\nimport { DETAILS_PAGE_INIT_STATE } from '../client/store/initials/detailsPageFlag';\nimport { CORE_INITIAL_STATE } from '../client/store/initials/coreState';\n\nimport { App } from '../client/components/app/app';\nimport {\n  getWHWallpaperFake,\n  getWHSearch,\n  getWHWallpaer,\n  getWHSearchFake,\n} from './wh-server-api';\nimport {\n  WHWpInfoProxyReq,\n  ProxyReq,\n  WHSearchProxyReq,\n} from './wh-server-api.def';\nimport { ProxyReqCodes } from '../shared/proxy.def';\n\nconst fs = require('fs');\nconst path = require('path');\nconst bodyParser = require('body-parser');\n\n// create express application\nconst app = Express();\n\nconst jsonParser = bodyParser.json();\n\nif (IS_DEV) {\n  app.get(/node_modules/, Express.static(path.resolve(__dirname, '../../')));\n}\n\napp.get(\n  /\\.(js|css|map|ico|png|jpeg|jpg)$/,\n  Express.static(path.resolve(__dirname, '../client')),\n);\n\nconst fetchOneWallpaper = IS_ONLINE ? getWHWallpaer : getWHWallpaperFake;\n\nconst proxyOneWHWalpaper = (res: Express.Response, req: WHWpInfoProxyReq) => {\n  fetchOneWallpaper(req)\n    .then(data => {\n      res.status(200);\n      return res.send(data);\n    })\n    .catch(err => {\n      console.error(\n        `Server encounter an error while fething one wallpaper: ${err} `,\n      );\n      res.status(500);\n      return res.send();\n    });\n};\n\nconst getWHSearchFunc = IS_ONLINE ? getWHSearch : getWHSearchFake;\n\nconst proxyWHSearch = (res: Express.Response, req: WHSearchProxyReq) => {\n  getWHSearchFunc(req)\n    .then(data => {\n      console.log(data);\n      res.status(200);\n      return res.send(data);\n    })\n    .catch(err => {\n      console.error(\n        `Server encounter an error while fething one wallpaper: ${err} `,\n      );\n      res.status(500);\n      return res.send();\n    });\n};\n\napp.post('/proxy', jsonParser, (req, res, next) => {\n  try {\n    const payload = req.body as ProxyReq;\n    console.log(req);\n    switch (payload.code) {\n      case ProxyReqCodes.WHWpInfo:\n        proxyOneWHWalpaper(res, payload as WHWpInfoProxyReq);\n        return;\n      case ProxyReqCodes.WHSearch:\n        proxyWHSearch(res, payload as WHSearchProxyReq);\n        return;\n      default:\n        throw new Error();\n    }\n  } catch {\n    res.status(404);\n    res.send('Unrecognizable proxy request');\n  }\n});\n\n// в ответ на любые другие запросы отправляем 'index.html'\napp.use('*', (req, res) => {\n  // читаем файл `index.html`\n  let indexHTML = fs.readFileSync(\n    path.resolve(__dirname, '../client/index.html'),\n    {\n      encoding: 'utf8',\n    },\n  );\n\n  const initState: State = {\n    galleryState: GALLERY_INITIAL_STATE,\n    detailsPageState: DETAILS_PAGE_INIT_STATE,\n    coreState: CORE_INITIAL_STATE,\n  };\n\n  const store = createStore(state => state, initState);\n  const context = {};\n\n  // получаем HTML строку из компонента 'App'\n  const appHTML = ReactDOMServer.renderToString(\n    <Provider store={store}>\n      <StaticRouter location={req.originalUrl} context={context}>\n        <App />\n      </StaticRouter>\n    </Provider>,\n  );\n\n  // заполняем элемент '#root' содержимым из 'appHTML'\n  // indexHTML = indexHTML.replace(\n  //   '&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;',\n  //   `&lt;div id=&quot;root&quot;&gt;${appHTML}&lt;/div&gt;`,\n  // );\n\n  indexHTML = indexHTML.replace(\n    '<div id=\"root\"></div>',\n    `<div id=\"root\">${appHTML}</div>`,\n  );\n\n  // устанавливаем заголовок и статус\n  res.contentType('text/html');\n  res.status(200);\n\n  return res.send(indexHTML);\n});\n// запускаем сервер на порту 9000\napp.listen('9000', () => {\n  console.log('Express server started at <http://localhost:9000>');\n});\n"],"names":[],"sourceRoot":""}